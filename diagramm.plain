===============================================
1. Sensorvalidierung
===============================================

Diagramm:
------------------------------------------------
            [Sensordaten-Eingang]
                      │
                      ▼
         [Überprüfung: Plausibilität?]
                      │
         ┌────────────┴────────────┐
         │                         │
 [Wert plausibel?]           [Wert unplausibel]
         │                         │
         ▼                         ▼
  [Weiterverarbeitung]      [Fallback-Wert einsetzen]
         │                         │
         ├───────────────► [Fehler loggen]
         │                         │
         └───────────────┬─────────┘
                      │
               [Bereinigte Daten]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Sicherstellung, dass nur plausible Sensordaten in die weiteren Berechnungen eingehen. Bei unplausiblen Werten wird automatisch ein vordefinierter Fallback-Wert (z. B. 50% für den Bewölkungsgrad) verwendet.
- **Erweiterung:** Zusätzlich zum Fallback erfolgt eine Protokollierung (Logging), um nachträglich nachvollziehen zu können, wann und warum ein Standardwert eingesetzt wurde.
- **Hintergrundwissen:** In Smart‑Home-Systemen und PV-Anwendungen ist es üblich, unplausible Sensordaten abzufangen, um die Stabilität der Gesamtberechnung zu sichern.

===============================================
2. Vektorbasiertes Standortmodell
===============================================

Diagramm:
------------------------------------------------
                 [Wetterstations-Daten]
                         │
       ┌─────────────────┴─────────────────┐
       │                                   │
[Koordinaten (Längengrad,                [Winddaten
  Breitengrad)]                         (Richtung & Stärke)]
       │                                   │
       └───────────────┬───────────────────┘
                       │
           [Berechnung der Standort-Vektoren]
                       │
               [Berechnung des Windvektors]
                       │
             [Berechnung des Dot-Produkts]
                       │
           [Ermittlung des Einflussfaktors]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Bestimmen, welche Wetterstationen – abhängig von ihrem relativen Standort und der momentanen Windrichtung – maßgeblichen Einfluss auf die WP-Steuerung haben.
- **Vorgehen:** 
  - Die geografischen Koordinaten werden zu Vektoren umgerechnet (z. B. unter Annahme von etwa 111 km pro Grad).
  - Parallel werden Winddaten in einen Vektor umgerechnet.
  - Mithilfe des Dot-Produkts wird der Einflussfaktor ermittelt: Werte nahe 1 bedeuten eine optimale Ausrichtung, niedrigere Werte reduzieren den Einfluss.
- **Hintergrundwissen:** Ansätze aus der PV-Ertragsprognose und Cloud-Tracking-Methoden belegen, dass nur dynamisch bestimmte Daten den tatsächlichen Einfluss widerspiegeln.

===============================================
3. Saisonaler Faktor
===============================================

Diagramm:
------------------------------------------------
               [Tag im Jahr]
                      │
                      ▼
         [Umrechnung in einen Winkel]
                      │
                      ▼
          [Anwendung der Sinusfunktion]
                      │
                      ▼
           [Ermittlung des Saisonfaktors]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Anpassung der WP-Berechnung an jahreszeitliche Schwankungen (z. B. intensivere Sonneneinstrahlung im Sommer, geringere im Winter).
- **Vorgehen:** Der jeweilige Tag im Jahr wird in einen Winkel umgerechnet, der dann über eine Sinusfunktion in einen Faktor übergeht.
- **Hintergrundwissen:** Dieser Ansatz wird in vielen Photovoltaik-Leistungsmodellen verwendet, um den natürlichen Verlauf der Sonnenintensität abzubilden.

===============================================
4. Entscheidungslogik
===============================================

Diagramm:
------------------------------------------------
         [Gewichtete WP-Werte pro Station]
                      │
                      ▼
         [Aggregation zu einem Gesamtwert]
                      │
                      ▼
    [Vergleich mit vordefinierten Schwellen]
                      │
         ┌────────────┴─────────────┐
         │            │             │
 [Gesamtwert < 40%] [40%-70%] [Gesamtwert > 70%]
         │            │             │
         ▼            ▼             ▼
       "JA"       "MODERAT"        "NEIN"
                      │
                      ▼
         [Prüfung auf große Windabweichung]
                      │
         ┌────────────┴─────────────┐
         │                          │
   Nein: Keine Änderung      Ja: Wert reduzieren & als unsicher markieren
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Es wird eine abschließende Entscheidung getroffen, ob die Wärmepumpe (WP) aktiviert wird.
- **Vorgehen:**
  - Zunächst werden die gewichteten WP-Werte aller Stationen aggregiert.
  - Der Gesamtwert wird mit definierten Schwellen verglichen:
    - Unter 40 % gilt als günstig („JA“).
    - Zwischen 40 % und 70 % als moderat.
    - Über 70 % als ungünstig („NEIN“).
  - Zusätzlich erfolgt eine Prüfung, ob die Winddaten stark auseinander liegen, was zu einer Unsicherheitskennzeichnung und einer Reduzierung des Wertes führen kann.
- **Hintergrundwissen:** Diese Logik stützt sich auf praktische Erfahrungen in der PV-basierten WP-Steuerung und relevante Branchenstandards.

===============================================
5. Feedbackschleife zur Parameteroptimierung
===============================================

Diagramm:
------------------------------------------------
     [Ergebnis: WP-Entscheidung]
                      │
                      ▼
         [Logging und Datenarchivierung]
                      │
                      ▼
         [Analyse / Feedback-Schleife]
                      │
                      ▼
    [Anpassung der Parameter & Gewichtungen]
                      │
                      └─────► [Neue WP-Berechnung]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Dieser Prozess dient der kontinuierlichen Optimierung der Parameter, basierend auf den bisherigen Ergebnissen.
- **Vorgehen:**
  - Nach der WP-Entscheidung werden die Ergebnisse geloggt und archiviert.
  - Eine Analysephase prüft, ob die getroffenen Entscheidungen mit den Erwartungen übereinstimmen.
  - Daraus werden Parameter und Gewichtungen angepasst, die dann in einer neuen Berechnung berücksichtigt werden.
- **Hintergrundwissen:** Iterative Anpassungen und Feedback-Loops sind in technischen Systemen üblich, um langfristig eine höhere Genauigkeit und Stabilität zu erreichen.

===============================================
6. Ausfallsicherung und Notfallmodus
===============================================

Diagramm:
------------------------------------------------
          [Sensordaten-Eingang]
                      │
                      ▼
         [Überprüfung: Daten vorhanden?]
                      │
         ┌────────────┴─────────────┐
         │                          │
 [Daten vorhanden]         [Keine Daten / Ausfall]
         │                          │
         ▼                          ▼
  [Weiter mit Standard-Prozess]   [Aktivierung des Notfallmodus]
                                           │
                                           ▼
                              [Setze Standardwerte & Alarmiere]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Sicherstellung des Betriebs auch bei Ausfällen kritischer Sensoren.
- **Vorgehen:**
  - Zunächst wird geprüft, ob überhaupt Daten vorliegen.
  - Fehlen die Daten, wird ein Notfallmodus aktiviert, in dem vordefinierte Standardwerte eingesetzt und ein Alarm (z. B. via Logging oder Benachrichtigung) ausgelöst wird.
- **Hintergrundwissen:** Die Ausfallsicherung ist ein wichtiger Bestandteil robuster Steuerungssysteme, um bei kritischen Hardware- oder Kommunikationsfehlern einen sicheren Betrieb gewährleisten zu können.

===============================================
7. Gesamtablauf / Zusammenfassung
===============================================

Diagramm:
------------------------------------------------
          [Sensordaten validieren]
                      │
                      ▼
            [Standortvektoren berechnen]
                      │
                      ▼
          [Saisonalen Faktor ermitteln]
                      │
                      ▼
        [WP-Werte der Stationen aggregieren]
                      │
                      ▼
         [Entscheidung via Schwellenwertvergleich]
                      │
                      ▼
          [Ergebnis: WP aktiv / moderat / nein]
------------------------------------------------

Erklärung & Hintergrund:
- **Zweck:** Kompakte Zusammenfassung aller Teilschritte im Entscheidungsprozess.
- **Vorgehen:**  
  - Beginnend mit der Validierung der Sensordaten werden alle wesentlichen Verarbeitungsschritte nacheinander durchgeführt.
  - Anschließend erfolgt die Aggregation und letztlich die Entscheidungsfindung, die im Endergebnis als "JA", "MODERAT" oder "NEIN" ausgegeben wird.
- **Hintergrundwissen:** Diese Gesamtübersicht dient als Reminder an den gesamten Workflow und erleichtert das Verständnis und Debugging des Systems.

===============================================
Ende der diagramm.plain
===============================================
